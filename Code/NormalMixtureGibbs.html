<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0014)about:internet -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">

<title>NormalMixtureGibbs.R</title>

<base target="_blank"/>

<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 12px;
   margin: 8px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 { 
   font-size:2.2em; 
}

h2 { 
   font-size:1.8em; 
}

h3 { 
   font-size:1.4em; 
}

h4 { 
   font-size:1.0em; 
}

h5 { 
   font-size:0.9em; 
}

h6 { 
   font-size:0.8em; 
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre {	
   margin-top: 0;
   max-width: 95%;
   border: 1px solid #ccc;
}

pre code {
   display: block; padding: 0.5em;
}

code.r {
   background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * { 
      background: transparent !important; 
      color: black !important; 
      filter:none !important; 
      -ms-filter: none !important; 
   }

   body { 
      font-size:12pt; 
      max-width:100%; 
   }
       
   a, a:visited { 
      text-decoration: underline; 
   }

   hr { 
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote { 
      padding-right: 1em; 
      page-break-inside: avoid; 
   }

   tr, img { 
      page-break-inside: avoid; 
   }

   img { 
      max-width: 100% !important; 
   }

   @page :left { 
      margin: 15mm 20mm 15mm 10mm; 
   }
     
   @page :right { 
      margin: 15mm 10mm 15mm 20mm; 
   }

   p, h2, h3 { 
      orphans: 3; widows: 3; 
   }

   h2, h3 { 
      page-break-after: avoid; 
   }
}

</style>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: rgb(88, 72, 246)
   }

   pre .number {
     color: rgb(0, 0, 205);
   }

   pre .comment {
     color: rgb(76, 136, 107);
   }

   pre .keyword {
     color: rgb(0, 0, 255);
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: rgb(3, 106, 7);
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>




</head>

<body>
<!-- Automatically generated by RStudio [12861c30b10411e1afa60800200c9a66] -->

<h3>NormalMixtureGibbs.R</h3>

<p>mv &mdash; <em>Nov 16, 2012, 12:11 AM</em></p>

<pre><code class="r"># Estimating a simple mixture of normals

#install.packages(&quot;geoR&quot;) # We need the rinvchisq() function for simulating random draws from the scaled inv chi-square.
library(geoR)
</code></pre>

<pre><code>Loading required package: sp
</code></pre>

<pre><code>Loading required package: MASS
</code></pre>

<pre><code>Spatial Point Pattern Analysis Code in S-Plus

Version 2 - Spatial and Space-Time analysis
</code></pre>

<pre><code>-------------------------------------------------------------- Analysis of
geostatistical data For an Introduction to geoR go to
http://www.leg.ufpr.br/geoR geoR version 1.7-4 (built on 2012-06-29) is
now loaded --------------------------------------------------------------
</code></pre>

<pre><code class="r">
# Data options
#rawData &lt;- read.table(&#39;/home/mv/Dropbox/Teaching/BayesLearn2012/Code/CanadianWages.dat&#39;, header = TRUE)
#x &lt;- as.matrix(rawData[&#39;logWage&#39;])
rawData &lt;- geyser
x &lt;- as.matrix(rawData[&#39;duration&#39;])


# Model options
nComp &lt;- 3    # Number of mixture components

# Prior options
alpha &lt;- 2*rep(1,nComp) # Dirichlet(alpha)
muPrior &lt;- rep(0,nComp)
tau2Prior &lt;- rep(100,nComp)
sigma2_0 &lt;- rep(var(x),nComp)
nu0 &lt;- rep(4,nComp)

# MCMC options
nIter &lt;- 10000 # Number of Gibbs sampling draws

# Plotting options
plotFit &lt;- TRUE
lineColors &lt;- c(&quot;red&quot;, &quot;green&quot;, &quot;blue&quot;, &quot;magenta&quot;)

# Initial value for the MCMC
nObs &lt;- length(x)
S &lt;- t(rmultinom(nObs, size = 1 , prob = rep(1/nComp,nComp))) # nObs-by-nComp matrix with component allocations.
theta &lt;- quantile(x, probs = seq(0,1,length = nComp))
sigma2 &lt;- rep(var(x),nComp)
probObsInComp &lt;- rep(NA, nComp)

# Setting up the plot
xGrid &lt;- seq(min(x)-1*apply(x,2,sd),max(x)+1*apply(x,2,sd),length = 100)
xGridMin &lt;- min(xGrid)
xGridMax &lt;- max(xGrid)
mixDensMean &lt;- rep(0,length(xGrid))
effIterCount &lt;- 0
ylim &lt;- c(0,2*max(hist(x)$intensities))
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-1"/> </p>

<pre><code class="r">x11()

for (k in 1:nIter){
  message(paste(&#39;Iteration number:&#39;,k))

  alloc &lt;- S2alloc(S) # Just a function that converts between different representations of the group allocations
  nAlloc &lt;- colSums(S)
  print(nAlloc)

  # Update components probabilities
  w &lt;- rDirichlet(alpha + nAlloc)

  # Update theta&#39;s
  for (j in 1:nComp){
    precPrior &lt;- 1/tau2Prior[j]
    precData &lt;- nAlloc[j]/sigma2[j]
    precPost &lt;- precPrior + precData
    wPrior &lt;- precPrior/precPost
    muPost &lt;- wPrior*muPrior + (1-wPrior)*mean(x[alloc == j])
    tau2Post &lt;- 1/precPost
    theta[j] &lt;- rnorm(1, mean = muPost, sd = sqrt(tau2Post))
  }

  # Update sigma2&#39;s
  for (j in 1:nComp){
    sigma2[j] &lt;- rinvchisq(1, df = nu0[j] + nAlloc[j], scale = (nu0[j]*sigma2_0[j] + sum((x[alloc == j] - theta[j])^2))/(nu0[j] + nAlloc[j]))
  }

  # Update allocation
  for (i in 1:nObs){
    for (j in 1:nComp){
      probObsInComp[j] &lt;- dnorm(x[i], mean = theta[j], sd = sigma2[j])
    }
    S[i,] &lt;- t(rmultinom(1, size = 1 , prob = probObsInComp/sum(probObsInComp)))
  }

  # Printing the fitted density against data histogram
  if (plotFit &amp;&amp; (k%%10 ==0)){
    effIterCount &lt;- effIterCount + 1
    hist(x, breaks = 30, freq = FALSE, xlim = c(xGridMin,xGridMax), main = paste(&quot;Iteration number&quot;,k), ylim = ylim)
    mixDens &lt;- rep(0,length(xGrid))
    components &lt;- c()
    for (j in 1:nComp){
      compDens &lt;- dnorm(xGrid,theta[j],sd = sqrt(sigma2[j]))
      mixDens &lt;- mixDens + w[j]*compDens
      lines(xGrid, compDens, type = &quot;l&quot;, lwd = 2, col = lineColors[j])
      components[j] &lt;- paste(&quot;Component &quot;,j)
    }
    mixDensMean &lt;- ((effIterCount-1)*mixDensMean + mixDens)/effIterCount

    lines(xGrid, mixDens, type = &quot;l&quot;, lwd = 3, col = &#39;black&#39;)
    legend(&quot;topleft&quot;, box.lty = 1, legend = c(&quot;Data histogram&quot;,components), 
           col = c(&quot;black&quot;,lineColors[1:nComp]), lwd = 2)
    Sys.sleep(0)
  }

}
</code></pre>

<pre><code>Iteration number: 1
</code></pre>

<pre><code>Error: could not find function &quot;S2alloc&quot;
</code></pre>

<pre><code class="r">
x11()
hist(x, breaks = 30, freq = FALSE, xlim = c(xGridMin,xGridMax), main = &quot;Final fitted density&quot;)
lines(xGrid, mixDensMean, type = &quot;l&quot;, lwd = 2, col = &quot;red&quot;)
lines(xGrid, dnorm(xGrid, mean = mean(x), sd = apply(x,2,sd)), type = &quot;l&quot;, lwd = 2, col = &quot;blue&quot;)
legend(&quot;topright&quot;, box.lty = 1, legend = c(&quot;Data histogram&quot;,&quot;Mixture density&quot;,&quot;Normal density&quot;), col=c(&quot;black&quot;,&quot;red&quot;,&quot;blue&quot;), lwd = 2)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-1"/> </p>

<pre><code class="r">
#########################    Helper functions    ##############################################

####### Defining a function that simulates from a Dirichlet distribution
rDirichlet &lt;- function(param){
  nCat &lt;- length(param)
  thetaDraws &lt;- matrix(NA,nCat,1)
  for (j in 1:nCat){
    thetaDraws[j] &lt;- rgamma(1,param[j],1)
  }
  thetaDraws = thetaDraws/sum(thetaDraws) # Diving every column of ThetaDraws by the sum of the elements in that column.
  return(thetaDraws)
}

# Simple function that converts between two different representations of the mixture allocation
S2alloc &lt;- function(S){
  n &lt;- dim(S)[1]
  alloc &lt;- rep(0,n)
  for (i in 1:n){
    alloc[i] &lt;- which(S[i,] == 1)
  }
  return(alloc)
} 
</code></pre>

</body>

</html>

